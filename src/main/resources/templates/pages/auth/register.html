<!DOCTYPE html>
<html lang="id" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Quality Inspector - Daftar Akun</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        .hidden { display: none; }
        .flex { display: flex; }
        
        /* Grid Pattern Halus */
        .bg-grid-slate {
            background-size: 40px 40px;
            background-image: linear-gradient(to right, rgba(148, 163, 184, 0.1) 1px, transparent 1px),
                              linear-gradient(to bottom, rgba(148, 163, 184, 0.1) 1px, transparent 1px);
        }

        /* Transisi Smooth untuk Bar Kekuatan Password */
        #strength-bar { transition: width 0.3s ease, background-color 0.3s ease; }
    </style>
</head>

<body class="bg-slate-50 min-h-screen text-slate-800 antialiased selection:bg-blue-500 selection:text-white relative">

    <!-- LAYER 1: Background Dekoratif (Sama dengan Login) -->
    <div class="fixed inset-0 z-0 pointer-events-none">
        <div class="absolute inset-0 bg-grid-slate [mask-image:linear-gradient(to_bottom,white,transparent)]"></div>
        <!-- Orbs -->
        <div class="absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-sky-200 rounded-full mix-blend-multiply filter blur-[80px] opacity-40 animate-pulse"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-[500px] h-[500px] bg-blue-200 rounded-full mix-blend-multiply filter blur-[80px] opacity-40 animate-pulse" style="animation-delay: 2s"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-cyan-100/50 rounded-full filter blur-[100px]"></div>
    </div>

    <!-- LAYER 2: Container Utama -->
    <div class="min-h-screen flex relative items-center justify-center p-4 lg:p-6 z-10">
        
        <!-- Kartu Register (Glassmorphism) -->
        <div class="flex w-full max-w-6xl bg-white/80 backdrop-blur-xl rounded-[2.5rem] shadow-[0_20px_50px_-12px_rgba(0,0,0,0.1)] border border-white/60 overflow-hidden min-h-[700px]">
            
            <!-- KIRI: Branding (Biru Gradient) -->
            <div class="hidden lg:flex lg:w-5/12 relative flex-col justify-between p-12 bg-gradient-to-br from-blue-600 via-blue-500 to-cyan-500 text-white overflow-hidden">
                <!-- Pattern Overlay -->
                <div class="absolute inset-0 opacity-20" style="background-image: radial-gradient(circle at 2px 2px, white 1px, transparent 0); background-size: 24px 24px;"></div>
                
                <!-- Dekorasi -->
                <div class="absolute -right-20 -top-20 w-80 h-80 bg-white/10 rounded-full blur-3xl"></div>
                <div class="absolute -left-20 -bottom-20 w-80 h-80 bg-cyan-400/20 rounded-full blur-3xl"></div>

                <div class="relative z-10">
                    <div class="flex items-center gap-3">
                        <div class="p-2.5 bg-white/20 backdrop-blur-md rounded-xl border border-white/20">
                            <i data-lucide="shield-check" class="w-6 h-6 text-white"></i>
                        </div>
                        <span class="font-bold text-lg tracking-wide">Food Inspector</span>
                    </div>
                </div>

                <div class="relative z-10 space-y-6">
                    <h2 class="text-4xl font-bold leading-tight">Bergabung Bersama Kami.</h2>
                    <p class="text-blue-50 text-lg leading-relaxed">Mulai perjalanan Anda dalam memastikan standar kualitas pangan terbaik.</p>
                    
                    <!-- Checklist Fitur -->
                    <div class="space-y-4 pt-4">
                        <div class="flex items-center gap-3 text-blue-50">
                            <div class="p-1 bg-white/20 rounded-full"><i data-lucide="check" class="w-4 h-4"></i></div>
                            <span class="text-sm font-medium">Dashboard Real-time</span>
                        </div>
                        <div class="flex items-center gap-3 text-blue-50">
                            <div class="p-1 bg-white/20 rounded-full"><i data-lucide="check" class="w-4 h-4"></i></div>
                            <span class="text-sm font-medium">Laporan Audit Otomatis</span>
                        </div>
                        <div class="flex items-center gap-3 text-blue-50">
                            <div class="p-1 bg-white/20 rounded-full"><i data-lucide="check" class="w-4 h-4"></i></div>
                            <span class="text-sm font-medium">Notifikasi Insiden</span>
                        </div>
                    </div>
                </div>

                <div class="relative z-10 text-xs text-blue-200">
                    Â© 2025 Food Quality Inspector System
                </div>
            </div>

            <!-- KANAN: Form Register -->
            <div class="w-full lg:w-7/12 p-8 lg:p-12 flex flex-col justify-center bg-white/40">
                <div class="max-w-md mx-auto w-full">
                    
                    <!-- Mobile Logo -->
                    <div class="lg:hidden mb-8 flex items-center gap-2">
                        <div class="p-2 bg-blue-600 rounded-lg text-white">
                            <i data-lucide="shield-check" class="w-6 h-6"></i>
                        </div>
                        <span class="font-bold text-xl text-slate-800">Food Inspector</span>
                    </div>

                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-slate-800 mb-2">Buat Akun Baru ðŸš€</h2>
                        <p class="text-slate-500">Lengkapi data di bawah untuk mendaftar.</p>
                    </div>

                    <!-- Form -->
                    <form id="registerForm" th:action="@{/auth/register/post}" th:object="${registerForm}" method="post" class="space-y-5" novalidate>
                        
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" th:if="${_csrf}" />

                        <!-- Nama Lengkap -->
                        <div class="space-y-1.5">
                            <label for="name" class="block text-sm font-semibold text-slate-700">Nama Lengkap</label>
                            <div class="relative group">
                                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                    <i data-lucide="user" class="h-5 w-5 text-slate-400 group-focus-within:text-blue-600 transition-colors"></i>
                                </div>
                                <input id="name" type="text" th:field="*{name}"
                                    class="w-full pl-11 pr-4 py-3.5 bg-white border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all shadow-sm text-slate-800 placeholder:text-slate-400"
                                    th:classappend="${#fields.hasErrors('name')} ? 'border-rose-500 focus:border-rose-500 focus:ring-rose-500/10' : ''"
                                    placeholder="Nama Lengkap Anda">
                            </div>
                            <p id="error-name" class="hidden text-xs text-rose-600 font-medium items-center gap-1 mt-1">
                                <span class="msg" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></span>
                            </p>
                        </div>

                        <!-- Email -->
                        <div class="space-y-1.5">
                            <label for="email" class="block text-sm font-semibold text-slate-700">Email Perusahaan</label>
                            <div class="relative group">
                                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                    <i data-lucide="mail" class="h-5 w-5 text-slate-400 group-focus-within:text-blue-600 transition-colors"></i>
                                </div>
                                <input id="email" type="email" th:field="*{email}"
                                    class="w-full pl-11 pr-4 py-3.5 bg-white border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all shadow-sm text-slate-800 placeholder:text-slate-400"
                                    th:classappend="${#fields.hasErrors('email')} ? 'border-rose-500 focus:border-rose-500 focus:ring-rose-500/10' : ''"
                                    placeholder="nama@perusahaan.com">
                            </div>
                            <p id="error-email" class="hidden text-xs text-rose-600 font-medium items-center gap-1 mt-1">
                                <span class="msg" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></span>
                            </p>
                        </div>

                        <!-- Password -->
                        <div class="space-y-1.5">
                            <label for="password" class="block text-sm font-semibold text-slate-700">Password</label>
                            <div class="relative group">
                                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                    <i data-lucide="lock" class="h-5 w-5 text-slate-400 group-focus-within:text-blue-600 transition-colors"></i>
                                </div>
                                <input id="password" type="password" th:field="*{password}"
                                    class="w-full pl-11 pr-12 py-3.5 bg-white border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all shadow-sm text-slate-800 placeholder:text-slate-400"
                                    th:classappend="${#fields.hasErrors('password')} ? 'border-rose-500 focus:border-rose-500 focus:ring-rose-500/10' : ''"
                                    placeholder="Minimal 8 karakter">
                                <button type="button" onclick="togglePassword('password', 'eye-pass', 'eye-off-pass')" 
                                    class="absolute inset-y-0 right-0 pr-4 flex items-center cursor-pointer text-slate-400 hover:text-blue-600 transition-colors outline-none">
                                    <i id="eye-pass" data-lucide="eye" class="h-5 w-5"></i>
                                    <i id="eye-off-pass" data-lucide="eye-off" class="h-5 w-5 hidden"></i>
                                </button>
                            </div>
                            
                            <!-- Strength Meter -->
                            <div id="password-strength-container" class="hidden pt-1">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="text-[10px] uppercase tracking-wider text-slate-500 font-bold">Kekuatan</span>
                                    <span id="strength-text" class="text-xs font-semibold text-slate-500">Lemah</span>
                                </div>
                                <div class="w-full bg-slate-100 rounded-full h-1.5 overflow-hidden">
                                    <div id="strength-bar" class="bg-rose-500 h-1.5 rounded-full w-0"></div>
                                </div>
                            </div>

                            <p id="error-password" class="hidden text-xs text-rose-600 font-medium items-center gap-1 mt-1">
                                <span class="msg" th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></span>
                            </p>
                        </div>

                        <!-- Confirm Password -->
                        <div class="space-y-1.5">
                            <label for="confirmPassword" class="block text-sm font-semibold text-slate-700">Konfirmasi Password</label>
                            <div class="relative group">
                                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                    <i data-lucide="lock" class="h-5 w-5 text-slate-400 group-focus-within:text-blue-600 transition-colors"></i>
                                </div>
                                <input id="confirmPassword" type="password" name="confirmPassword"
                                    class="w-full pl-11 pr-12 py-3.5 bg-white border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all shadow-sm text-slate-800 placeholder:text-slate-400"
                                    placeholder="Ulangi password">
                                <button type="button" onclick="togglePassword('confirmPassword', 'eye-conf', 'eye-off-conf')" 
                                    class="absolute inset-y-0 right-0 pr-4 flex items-center cursor-pointer text-slate-400 hover:text-blue-600 transition-colors outline-none">
                                    <i id="eye-conf" data-lucide="eye" class="h-5 w-5"></i>
                                    <i id="eye-off-conf" data-lucide="eye-off" class="h-5 w-5 hidden"></i>
                                </button>
                            </div>
                            <p id="error-confirmPassword" class="hidden text-xs text-rose-600 font-medium items-center gap-1 mt-1">
                                <span class="msg">Password tidak cocok</span>
                            </p>
                        </div>

                        <!-- Terms -->
                        <div class="flex items-start pt-1">
                            <div class="flex items-center h-5">
                                <input id="terms" type="checkbox" required class="w-4 h-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500 cursor-pointer">
                            </div>
                            <div class="ml-2 text-sm">
                                <label for="terms" class="font-medium text-slate-600">Saya setuju dengan <a href="#" class="text-blue-600 hover:text-blue-700 hover:underline">syarat dan ketentuan</a>.</label>
                            </div>
                        </div>

                        <!-- Button -->
                        <button type="submit" class="group w-full bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl transition-all shadow-lg shadow-blue-600/30 flex items-center justify-center gap-2 transform hover:-translate-y-0.5 active:translate-y-0 active:scale-[0.98]">
                            <span class="font-bold tracking-wide">Daftar Sekarang</span>
                            <i data-lucide="arrow-right" class="w-5 h-5 group-hover:translate-x-1 transition-transform"></i>
                        </button>
                    </form>

                    <!-- Footer -->
                    <div class="mt-8 text-center">
                        <p class="text-sm text-slate-500 font-medium">
                            Sudah punya akun? 
                            <a th:href="@{/auth/login}" class="text-blue-600 hover:text-blue-700 font-bold ml-1 hover:underline transition-all">
                                Masuk di sini
                            </a>
                        </p>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // Toggle Password Visibility (Reusable)
        function togglePassword(inputId, eyeId, eyeOffId) {
            const input = document.getElementById(inputId);
            const eye = document.getElementById(eyeId);
            const eyeOff = document.getElementById(eyeOffId);
            if (input.type === 'password') {
                input.type = 'text'; eye.classList.add('hidden'); eyeOff.classList.remove('hidden');
            } else {
                input.type = 'password'; eye.classList.remove('hidden'); eyeOff.classList.add('hidden');
            }
        }

        // Strength Logic
        const passInput = document.getElementById('password');
        const strengthContainer = document.getElementById('password-strength-container');
        const strengthBar = document.getElementById('strength-bar');
        const strengthText = document.getElementById('strength-text');

        passInput.addEventListener('input', function() {
            const val = this.value;
            if(val.length > 0) strengthContainer.classList.remove('hidden');
            else { strengthContainer.classList.add('hidden'); return; }

            let strength = 0; let color = 'bg-rose-500'; let label = 'Lemah';
            
            // Simple Logic for Demo
            if (val.length >= 8) strength += 25;
            if (val.match(/[A-Z]/)) strength += 25;
            if (val.match(/[0-9]/)) strength += 25;
            if (val.match(/[^A-Za-z0-9]/)) strength += 25;

            if (strength <= 25) { color = 'bg-rose-500'; label = 'Lemah'; }
            else if (strength <= 50) { color = 'bg-amber-500'; label = 'Sedang'; }
            else if (strength <= 75) { color = 'bg-blue-500'; label = 'Kuat'; }
            else { color = 'bg-emerald-500'; label = 'Sangat Kuat'; }

            strengthBar.style.width = strength + '%';
            strengthBar.className = `h-1.5 rounded-full transition-all duration-300 ${color}`;
            strengthText.innerText = label;
            
            // Text color logic
            if (strength <= 25) strengthText.className = 'text-xs font-semibold text-rose-500';
            else if (strength <= 50) strengthText.className = 'text-xs font-semibold text-amber-500';
            else if (strength <= 75) strengthText.className = 'text-xs font-semibold text-blue-500';
            else strengthText.className = 'text-xs font-semibold text-emerald-500';
        });

        // Form Validation
        const form = document.getElementById('registerForm');
        form.addEventListener('submit', function(e) {
            const name = document.getElementById('name');
            const email = document.getElementById('email');
            const password = document.getElementById('password');
            const confirmPassword = document.getElementById('confirmPassword');
            const terms = document.getElementById('terms');
            let hasError = false;

            const showError = (input, msg) => {
                const errP = document.getElementById(`error-${input.id}`);
                input.classList.add('border-rose-500', 'focus:border-rose-500', 'focus:ring-rose-500/10');
                input.classList.remove('border-slate-200');
                
                // Cari elemen pesan error. Untuk confirm pass, strukturnya sedikit beda di HTML, 
                // tapi logic class ini cukup umum.
                const msgSpan = errP.querySelector('.msg') || errP;
                msgSpan.innerText = msg;
                
                errP.classList.remove('hidden');
                errP.classList.add('flex');
                hasError = true;
            };

            const clearError = (input) => {
                if(input.value.trim() !== "") {
                    const errP = document.getElementById(`error-${input.id}`);
                    input.classList.remove('border-rose-500', 'focus:border-rose-500', 'focus:ring-rose-500/10');
                    input.classList.add('border-slate-200');
                    if(errP) {
                        errP.classList.add('hidden');
                        errP.classList.remove('flex');
                    }
                }
            };

            // Validate logic
            if (!name.value.trim()) showError(name, 'Nama wajib diisi');
            else clearError(name);

            if (!email.value.trim()) showError(email, 'Email wajib diisi');
            else clearError(email);

            if (!password.value) showError(password, 'Password wajib diisi');
            else if (password.value.length < 6) showError(password, 'Minimal 6 karakter');
            else clearError(password);

            if (!confirmPassword.value) showError(confirmPassword, 'Konfirmasi wajib diisi');
            else if (password.value !== confirmPassword.value) showError(confirmPassword, 'Password tidak cocok');
            else clearError(confirmPassword);

            if (!terms.checked) {
                alert('Anda harus menyetujui syarat dan ketentuan');
                hasError = true;
            }

            if (hasError) e.preventDefault();
        });

        // Reset error on input
        ['name', 'email', 'password', 'confirmPassword'].forEach(id => {
            const el = document.getElementById(id);
            if(el) {
                el.addEventListener('input', function() {
                    if(this.classList.contains('border-rose-500')) {
                        this.classList.remove('border-rose-500', 'focus:border-rose-500', 'focus:ring-rose-500/10');
                        this.classList.add('border-slate-200');
                        const err = document.getElementById(`error-${id}`);
                        if(err) err.classList.add('hidden');
                    }
                });
            }
        });
    </script>
</body>
</html>